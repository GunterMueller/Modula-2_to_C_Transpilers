DEFINITION MODULE Printer;
(* Pretty printing auxiliary functions for use with Modula-2 pretty printing
   program generated by COCO from an attributed grammar
   P.D. Terry, Rhodes University, 1995 *)

(* Modified by Milos Radovanovic, 2000, 2001 *)

  IMPORT FileIO;

  VAR
    results : FileIO.FileT;
    resultsName : ARRAY [0..255] OF CHAR;

  PROCEDURE OpenResults(modName, ext: ARRAY OF CHAR);
  (* Open results file, named after modName with the extension ext *)

  PROCEDURE CloseResults;
  (* Close results file *)

  PROCEDURE Flush;
  (* Copy output buffer to results file  *)

  PROCEDURE MarkPrependPos;
  (* Use current position in buffer in subsequent calls to Prepend *)

  PROCEDURE Prepend (Str : ARRAY OF CHAR);
  (* Insert String to output buffer at position set by MarkPrependPos *)

  PROCEDURE Append (Str : ARRAY OF CHAR);
  (* Append String to output buffer *)

  PROCEDURE AppendLabel (L : CARDINAL);
  (* Append L to output buffer *)

  PROCEDURE Insert(Str : ARRAY OF CHAR; Pos: CARDINAL);
  (* Insert String to output buffer at position pos *)

  PROCEDURE IndentNextLine;
  (* If output buffer has characters other than spaces, copy output buffer and
     line mark to results file.  Prepare to indent further lines by two
     spaces more than before *)

  PROCEDURE ExdentNextLine;
  (* If output buffer has characters other than spaces, copy output buffer and
     line mark to results file.  Prepare to indent further lines by two
     spaces less than before *)

  PROCEDURE NewLine;
  (* If output buffer has characters other than spaces, copy output buffer and
     line mark to results file  *)

  PROCEDURE BlankLine;
  (* NewLine, followed by line mark *)

  PROCEDURE Indent;
  (* Increment indentation level by two spaces *)

  PROCEDURE Exdent;
  (* Decrement indentation level by two spaces *)

  PROCEDURE BackTrack (Old, New : ARRAY OF CHAR);
  (* Replace Old by New in pending buffer *)

  PROCEDURE GetPos(VAR Pos: CARDINAL);
  (* Set Pos to the current position in pending buffer *)

  PROCEDURE GetBuffer (VAR Str : ARRAY OF CHAR);
  (* Copy buffer contents to Str, without spaces at the beginning *)

  PROCEDURE DelBuffer;
  (* Delete contents of the buffer, leaving spaces at the beginning *)

  END Printer.
